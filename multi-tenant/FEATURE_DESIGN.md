# å¤šç§Ÿæˆ·å®ä¾‹ç®¡ç† - åŠŸèƒ½æ‰©å±•è®¾è®¡

## 1. URLç”Ÿæˆå¯é…ç½®åŒ–

### 1.1 å½“å‰å®ç°
```typescript
url: `https://${instanceName}.openclaw.app`
```

### 1.2 ç¯å¢ƒå˜é‡é…ç½®
```bash
# .env
# å®ä¾‹URLé…ç½®
INSTANCE_BASE_DOMAIN=openclaw.app
INSTANCE_URL_FORMAT={name}.{baseDomain}
INSTANCE_URL_SCHEME=https
```

### 1.3 URLæ ¼å¼ç¤ºä¾‹
| æ ¼å¼æ¨¡å¼ | ç¤ºä¾‹ç»“æœ |
|---------|---------|
| `{name}.{baseDomain}` | `test-prod.openclaw.app` |
| `{baseDomain}/instance/{name}` | `openclaw.app/instance/test-prod` |
| `{name}.{baseDomain}:443` | `test-prod.openclaw.app:443` |

### 1.4 å®ç°ä½ç½®
- `src/config.ts` - æ·»åŠ é…ç½®schema
- `src/instance-service.ts` - `generateInstanceUrl()` å‡½æ•°

---

## 2. å†…åµŒChatæŠ½å±‰åŠŸèƒ½

### 2.1 UIè®¾è®¡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OpenClaw  æ§åˆ¶å°  dev@example.com    [Refresh] [Hosts] [Logout]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æˆ‘çš„å®ä¾‹ (3ä¸ª)                              [+ åˆ›å»ºæ–°å®ä¾‹]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ test-prod   â”‚  â”‚ test-stagingâ”‚  â”‚ local-hw-001â”‚         â”‚
â”‚  â”‚ è¿è¡Œä¸­ â—     â”‚  â”‚ è¿è¡Œä¸­ â—     â”‚  â”‚ è¿è¡Œä¸­ â—     â”‚         â”‚
â”‚  â”‚ [ğŸ’¬][ğŸ”—]     â”‚  â”‚ [ğŸ’¬][ğŸ”—]     â”‚  â”‚ [ğŸ’¬][ğŸ”—]     â”‚         â”‚
â”‚  â”‚ [ğŸ—‘ï¸]         â”‚  â”‚ [ğŸ—‘ï¸]         â”‚  â”‚ [ğŸ—‘ï¸]         â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â†“ ç‚¹å‡»[ğŸ’¬]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ test-prod   â”‚  â† æ¿€æ´»             â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚ è¿è¡Œä¸­ â—     â”‚                     â”‚  â”‚  ğŸ’¬ Chat UI    â”‚  â”‚  â”‚
â”‚  â”‚ [ğŸ’¬][ğŸ”—]     â”‚                     â”‚  â”‚                â”‚  â”‚  â”‚
â”‚  â”‚             â”‚                     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚ å®¹å™¨ID:     â”‚                     â”‚  â”‚  â”‚ iframe   â”‚   â”‚  â”‚
â”‚  â”‚ openclaw-xxxâ”‚                     â”‚  â”‚  â”‚ åŠ è½½ä¸­.. â”‚   â”‚  â”‚
â”‚  â”‚             â”‚                     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚  â”‚                â”‚  â”‚
â”‚                                      â”‚  â”‚ [æ–°çª—å£] [å…³é—­] â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚ test-stagingâ”‚                     â”‚                    â”‚
â”‚  â”‚ è¿è¡Œä¸­ â—     â”‚                     â”‚  æŠ½å±‰å®½åº¦: 60%      â”‚
â”‚  â”‚ [ğŸ’¬][ğŸ”—]     â”‚                     â”‚  ä½ç½®: å³ä¾§          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚  å¯æ‹–æ‹½è°ƒæ•´å®½åº¦     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ç»„ä»¶ç»“æ„
```
frontend/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”œâ”€â”€ ChatDrawer.tsx       # ä¸»æŠ½å±‰ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ChatButton.tsx       # ChatæŒ‰é’®
â”‚   â”‚   â”œâ”€â”€ ChatIframe.tsx       # iframeå°è£…
â”‚   â”‚   â””â”€â”€ ChatLoading.tsx      # åŠ è½½çŠ¶æ€
â”‚   â””â”€â”€ ui/
â”‚       â”œâ”€â”€ drawer.tsx           # é€šç”¨æŠ½å±‰ç»„ä»¶
â”‚       â””â”€â”€ resizable.tsx        # å¯è°ƒæ•´å¤§å°
```

### 2.3 æŠ€æœ¯è¦ç‚¹

**CORSé…ç½®**
```typescript
// å®ä¾‹ç¯å¢ƒå˜é‡
CORS_ALLOWED_ORIGINS=http://localhost:3001,https://app.openclaw.app
```

**iframeå®‰å…¨é…ç½®**
```tsx
<iframe
  src={instanceUrl}
  sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-modals"
  allow="microphone; camera; clipboard-write"
/>
```

### 2.4 äº¤äº’æµç¨‹
1. ç”¨æˆ·ç‚¹å‡»å®ä¾‹å¡ç‰‡ä¸Šçš„[ğŸ’¬]æŒ‰é’®
2. å³ä¾§æ»‘å‡º60%å®½åº¦çš„æŠ½å±‰
3. iframeåŠ è½½OpenClaw Chat UI
4. ç”¨æˆ·å¯ä»¥åœ¨æŠ½å±‰å†…ä¸Chatäº¤äº’
5. å¯ç‚¹å‡»"æ–°çª—å£æ‰“å¼€"åœ¨ç‹¬ç«‹æ ‡ç­¾é¡µä¸­ä½¿ç”¨

---

## 3. è‡ªå®šä¹‰å®ä¾‹æ¥å…¥

### 3.1 æ•°æ®æ¨¡å‹æ‰©å±•

```sql
-- æ‰©å±• instances è¡¨
ALTER TABLE instances ADD COLUMN source TEXT DEFAULT 'managed';
ALTER TABLE instances ADD COLUMN custom_url TEXT;
ALTER TABLE instances ADD COLUMN health_check_url TEXT;
ALTER TABLE instances ADD COLUMN health_check_interval INT DEFAULT 60;
ALTER TABLE instances ADD COLUMN last_health_check TIMESTAMP;
ALTER TABLE instances ADD COLUMN is_healthy BOOLEAN;
```

### 3.2 ç±»å‹å®šä¹‰

```typescript
export type InstanceSource = 'managed' | 'custom' | 'hardware';

export interface Instance {
  // ç°æœ‰å­—æ®µ...

  // æ–°å¢å­—æ®µ
  source: InstanceSource;
  customUrl?: string;
  healthCheckUrl?: string;
  lastHealthCheck?: string;
  isHealthy?: boolean;
  healthCheckInterval?: number;
}

export interface RegisterCustomInstanceInput {
  name: string;
  instanceType: 'cloud' | 'hardware';

  // äº‘ç«¯å®ä¾‹
  url?: string;

  // ç¡¬ä»¶ç›’å­
  ip?: string;
  port?: number;

  // é€šç”¨
  apiToken?: string;
  healthCheckUrl?: string;
}
```

### 3.3 æ¥å…¥æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¥å…¥è‡ªå®šä¹‰å®ä¾‹                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å®ä¾‹åç§° *                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ my-existing-instance              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                          â”‚
â”‚  å®ä¾‹ç±»å‹ *                               â”‚
â”‚  â—‹ äº‘ç«¯å®ä¾‹  â— ç¡¬ä»¶ç›’å­                  â”‚
â”‚                                          â”‚
â”‚  è¿æ¥ä¿¡æ¯ *                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ è®¿é—®åœ°å€                            â”‚   â”‚
â”‚  â”‚ https://my-claw.example.com     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ API Token (å¯é€‰)                  â”‚   â”‚
â”‚  â”‚ â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                          â”‚
â”‚  å¥åº·æ£€æŸ¥ç«¯ç‚¹ (å¯é€‰)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ /health æˆ– /api/health           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                          â”‚
â”‚  [éªŒè¯è¿æ¥]                               â”‚
â”‚                                          â”‚
â”‚  â„¹ï¸  æ¥å…¥åæ‚¨å¯ä»¥åœ¨æ§åˆ¶å°ç»Ÿä¸€ç®¡ç†        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 éªŒè¯æµç¨‹

```typescript
async function validateCustomInstance(input: RegisterCustomInstanceInput) {
  const results = {
    urlValid: false,
    apiAccessible: false,
    healthCheck: false,
  };

  try {
    // 1. éªŒè¯URLå¯è®¿é—®æ€§
    const response = await fetch(input.url, { method: 'HEAD', mode: 'no-cors' });
    results.urlValid = true;

    // 2. éªŒè¯API (å¦‚æœæä¾›token)
    if (input.apiToken) {
      const apiResponse = await fetch(`${input.url}/api/health`, {
        headers: { 'Authorization': `Bearer ${input.apiToken}` }
      });
      results.apiAccessible = apiResponse.ok;
    }

    // 3. å¥åº·æ£€æŸ¥
    const healthUrl = input.healthCheckUrl || `${input.url}/health`;
    const healthResponse = await fetch(healthUrl);
    results.healthCheck = healthResponse.ok;

    return results;
  } catch (error) {
    throw new Error('è¿æ¥éªŒè¯å¤±è´¥');
  }
}
```

---

## 4. ç¡¬ä»¶ç›’å­æ”¯æŒ

### 4.1 ç‰¹æ®Šå¤„ç†

ç¡¬ä»¶ç›’å­åœºæ™¯éœ€è¦ç‰¹æ®Šå¤„ç†ï¼š

1. **æœ¬åœ°ç½‘ç»œå‘ç°** - æ‰«æå±€åŸŸç½‘å†…è¿è¡ŒOpenClawçš„è®¾å¤‡
2. **ç›´æ¥IPè¿æ¥** - ä¸ä¾èµ–DNS
3. **ç¦»çº¿çŠ¶æ€å¤„ç†** - ç¡¬ä»¶å¯èƒ½æš‚æ—¶ç¦»çº¿
4. **è‡ªåŠ¨é‡è¿** - å®šæœŸå°è¯•è¿æ¥

### 4.2 å±€åŸŸç½‘æ‰«æ (å¯é€‰åŠŸèƒ½)

```typescript
async function scanLocalNetwork(): Promise<Device[]> {
  const devices: Device[] = [];
  const subnet = '192.168.1'; // å¯é…ç½®

  for (let i = 1; i <= 254; i++) {
    const ip = `${subnet}.${i}`;
    try {
      const response = await fetch(`http://${ip}:18789/health`, {
        signal: AbortSignal.timeout(1000) // 1ç§’è¶…æ—¶
      });
      if (response.ok) {
        devices.push({
          ip,
          name: `Device ${i}`,
          type: 'hardware',
        });
      }
    } catch {
      // å¿½ç•¥ä¸å¯è¾¾çš„è®¾å¤‡
    }
  }

  return devices;
}
```

### 4.3 ç¡¬ä»¶ç›’å­UIå·®å¼‚åŒ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ local-hw-001 (ç¡¬ä»¶ç›’å­)    â”‚
â”‚ ğŸŸ¢ åœ¨çº¿ (192.168.1.100)   â”‚
â”‚                          â”‚
â”‚ [ğŸ’¬ Chat] [ğŸ”— æ‰“å¼€] [ğŸ”„ åˆ·æ–°]â”‚
â”‚ [ğŸ—‘ï¸ ç§»é™¤]                â”‚
â”‚                          â”‚
â”‚ å®¹å™¨ID: openclaw-hw-001   â”‚
â”‚ å›ºä»¶ç‰ˆæœ¬: v1.2.3          â”‚
â”‚ æœ€åè¿æ¥: 2åˆ†é’Ÿå‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ home-box (è‡ªå®šä¹‰)         â”‚
â”‚ ğŸ”´ ç¦»çº¿                   â”‚
â”‚                          â”‚
â”‚ [ğŸ’¬ Chat] [ğŸ”— æ‰“å¼€] [ğŸ”„ é‡è¯•]â”‚
â”‚ [ğŸ—‘ï¸ ç§»é™¤]                â”‚
â”‚                          â”‚
â”‚ ç±»å‹: ç¡¬ä»¶ç›’å­            â”‚
â”‚ IP: 192.168.1.105        â”‚
â”‚ ç¦»çº¿æ—¶é—´: 1å°æ—¶å‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. APIè®¾è®¡

### 5.1 å®ä¾‹ç®¡ç†API

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/instances` | GET | è·å–æ‰€æœ‰å®ä¾‹ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰ï¼‰ |
| `/api/instances` | POST | åˆ›å»ºæ‰˜ç®¡å®ä¾‹ |
| `/api/instances/custom` | POST | æ¥å…¥è‡ªå®šä¹‰å®ä¾‹ |
| `/api/instances/custom/:id/validate` | POST | éªŒè¯è‡ªå®šä¹‰å®ä¾‹è¿æ¥ |
| `/api/instances/:id/health` | GET | å¥åº·æ£€æŸ¥ |
| `/api/instances/:id` | DELETE | åˆ é™¤/ç§»é™¤å®ä¾‹ |
| `/api/instances/:id/restart` | POST | é‡å¯å®ä¾‹ (ä»…æ‰˜ç®¡) |

### 5.2 è‡ªå®šä¹‰å®ä¾‹è¯·æ±‚ç¤ºä¾‹

```bash
# æ¥å…¥äº‘ç«¯å®ä¾‹
curl -X POST http://localhost:3000/api/instances/custom \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "name": "my-existing",
    "instanceType": "cloud",
    "url": "https://my-claw.example.com",
    "apiToken": "optional-token",
    "healthCheckUrl": "https://my-claw.example.com/health"
  }'

# æ¥å…¥ç¡¬ä»¶ç›’å­
curl -X POST http://localhost:3000/api/instances/custom \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "name": "home-box",
    "instanceType": "hardware",
    "ip": "192.168.1.100",
    "port": 18789,
    "healthCheckUrl": "http://192.168.1.100:18789/health"
  }'
```

---

## 6. å®ç°ä¼˜å…ˆçº§

### Phase 1: åŸºç¡€åŠŸèƒ½ (å½“å‰å®ç°)
- [x] å¤šå®ä¾‹æ”¯æŒ
- [x] å®¹å™¨åæ˜¾ç¤º
- [x] å®¹å™¨IDå¤åˆ¶åŠŸèƒ½

### Phase 2: URLé…ç½® (ä¸‹ä¸€æ­¥)
- [ ] URLç”Ÿæˆå¯é…ç½®åŒ–
- [ ] ç¯å¢ƒå˜é‡é…ç½®
- [ ] å¤šç§URLæ ¼å¼æ”¯æŒ

### Phase 3: ChatæŠ½å±‰
- [ ] ChatDrawerç»„ä»¶ (60%å®½åº¦)
- [ ] ChatæŒ‰é’®
- [ ] iframeåŠ è½½
- [ ] CORSé…ç½®

### Phase 4: è‡ªå®šä¹‰å®ä¾‹
- [ ] æ•°æ®åº“schemaæ‰©å±•
- [ ] æ¥å…¥è¡¨å•UI
- [ ] è¿æ¥éªŒè¯
- [ ] å¥åº·æ£€æŸ¥

### Phase 5: ç¡¬ä»¶ç›’å­
- [ ] å±€åŸŸç½‘æ‰«æ (å¯é€‰)
- [ ] IPç›´è¿æ”¯æŒ
- [ ] ç¦»çº¿çŠ¶æ€å¤„ç†
- [ ] è‡ªåŠ¨é‡è¿

---

## 7. æ–‡ä»¶å˜æ›´æ¸…å•

### åç«¯
- `src/config.ts` - URLé…ç½®
- `src/database.ts` - schemaæ‰©å±•
- `src/instance-service.ts` - URLç”Ÿæˆé€»è¾‘
- `src/routes.ts` - æ–°APIç«¯ç‚¹
- `src/health-check.ts` - å¥åº·æ£€æŸ¥æœåŠ¡ (æ–°å»º)

### å‰ç«¯
- `src/types/instance.ts` - ç±»å‹æ‰©å±•
- `src/lib/api/instances.ts` - APIè°ƒç”¨
- `src/components/chat/` - Chatç›¸å…³ç»„ä»¶ (æ–°å»º)
- `src/app/dashboard/page.tsx` - UIæ›´æ–°
- `.env.local` - ç¯å¢ƒå˜é‡ç¤ºä¾‹

---

## 8. æµ‹è¯•åœºæ™¯

### åœºæ™¯1: åˆ›å»ºæ‰˜ç®¡å®ä¾‹
1. ç”¨æˆ·ç‚¹å‡»"åˆ›å»ºæ–°å®ä¾‹"
2. ç³»ç»Ÿè‡ªåŠ¨ç”ŸæˆURL: `{name}.openclaw.app`
3. å®¹å™¨å: `openclaw-{name}`

### åœºæ™¯2: ChatæŠ½å±‰
1. ç”¨æˆ·ç‚¹å‡»å®ä¾‹çš„[ğŸ’¬]æŒ‰é’®
2. å³ä¾§æŠ½å±‰æ»‘å‡º (60%å®½åº¦)
3. iframeåŠ è½½Chat UI
4. ç”¨æˆ·å¯ä»¥æ­£å¸¸äº¤äº’

### åœºæ™¯3: æ¥å…¥å·²æœ‰å®ä¾‹
1. ç”¨æˆ·å·²æœ‰OpenClawéƒ¨ç½²åœ¨ `my-claw.example.com`
2. ç‚¹å‡»"æ¥å…¥å®ä¾‹"
3. è¾“å…¥åç§°å’ŒURL
4. éªŒè¯è¿æ¥æˆåŠŸåæ¥å…¥

### åœºæ™¯4: ç¡¬ä»¶ç›’å­
1. ç”¨æˆ·æœ‰æœ¬åœ°OpenClawç¡¬ä»¶ç›’å­
2. IP: `192.168.1.100`
3. æ¥å…¥åæ˜¾ç¤ºç±»å‹ä¸º"ç¡¬ä»¶ç›’å­"
4. å¯ä»¥æ­£å¸¸ä½¿ç”¨ChatåŠŸèƒ½
